%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Preamble

%%% Document Type
\documentclass[11pt]{article}

%%% Packages
\usepackage{amsmath,amssymb,cancel,units} % math environment and symbols
\usepackage{array}                        % for better arrays (eg matrices) in maths
\usepackage{paralist}                     % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim}                     % adds environment for commenting out blocks of text & for better verbatim
\usepackage[pdftex,bookmarks,colorlinks,breaklinks]{hyperref}  % PDF hyperlinks, with coloured links
\usepackage{memhfixc}                     % remove conflict between the memoir class & hyperref
\usepackage{graphicx}                     % Add graphics capabilities
\usepackage{xspace}                        % smart space insertion after commands
\usepackage{tabulary}
\usepackage[table]{xcolor} % http://tex.stackexchange.com/questions/5363/how-to-create-alternating-rows-in-a-table

%%% Notation and Variables
\newcommand{\hostTreeSamples}{\mathcal{T}}
\newcommand{\sourceHostTree}{\bar{T}}
\newcommand{\augmentedHostTreeSamples}{\mathbf{T}^{*}}
\newcommand{\simulationTime}{\tau}
\newcommand{\hostEvent}{\eta}
\newcommand{\hostEventSchedule}{\mathcal{H}}
\newcommand{\hostEventScheduleSamples}{\mathbb{H}}
\newcommand{\symbiontTree}{\psi}
\newcommand{\scaledSymbiontTree}{\psi\prime}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Main Document
\begin{document}
% \rowcolors{2}{gray!25}{gray!15}

\title{INPHEST Development Journal}
\maketitle

\section{Simulation of Summary Statistics}
\label{summary-statistics-simulation-workflow} % Note: to create an within-document reference here, use: 'See \href{\#summary-statistics-simulation-workflow}{here}'

\begin{enumerate}
    \item Generate source host tree $\sourceHostTree$.
    \begin{description}
        \item[Inputs]  \hfill \\
            \begin{minipage}[t]{\linewidth}
                \begin{compactitem}
                    \item Sequence data.
                    \item Divergence time calibration priors.
                \end{compactitem}
            \end{minipage}
        \item[Outputs]  \hfill \\
            \begin{minipage}[t]{\linewidth}
                \begin{compactitem}
                    \item Time-calibrated phylogeny, $\sourceHostTree$.
                \end{compactitem}
            \end{minipage}
        \item[Procedure]  \hfill \\
            \begin{minipage}[t]{\linewidth}
                \begin{compactitem}
                    \item Use \texttt{BEAST} to generate sample from the posterior distribution of trees given the data, $\hostTreeSamples$.
                    \item Summarize $\hostTreeSamples$ using MCCT or other criteria to produce $\sourceHostTree$.
                \end{compactitem}
            \end{minipage}
    \end{description}

    \item Generate samples of augmented host trees, $\augmentedHostTreeSamples$, conditioned on source host tree, $\sourceHostTree$.
    \begin{description}
        \item[Inputs]  \hfill \\
            \begin{minipage}[t]{\linewidth}
                \begin{compactitem}
                    \item Time-calibrated phylogeny, $\sourceHostTree$.
                    \item Labeling of tips on $\sourceHostTree$ by geography (distributional range, specified as presence/absence over set of areas, for each tip).
                \end{compactitem}
            \end{minipage}
        \item[Outputs]  \hfill \\
            \begin{minipage}[t]{\linewidth}
                \begin{compactitem}
                    \item Samples of host tree augmented with biogeographical history $\augmentedHostTreeSamples$.
                \end{compactitem}
            \end{minipage}
        \item[Procedure]  \hfill \\
            \begin{minipage}[t]{\linewidth}
                \begin{compactitem}
                    \item Use \texttt{BayArea} or \texttt{RevBayes} to generate stochastic mapped samples.
                \end{compactitem}
            \end{minipage}
    \end{description}

    \item Generate samples of schedule of host events, $\hostEventScheduleSamples$.
    \begin{description}
        \item[Inputs]  \hfill \\
            \begin{minipage}[t]{\linewidth}
                \begin{compactitem}
                    \item Samples of host tree augmented with biogeographical history $\augmentedHostTreeSamples$.
                \end{compactitem}
            \end{minipage}
        \item[Outputs]  \hfill \\
            \begin{minipage}[t]{\linewidth}
                \begin{compactitem}
                    \item Samples of a schedule of host events, $\hostEventScheduleSamples$, where each distinct element $\hostEventSchedule_i, \hostEventSchedule_i \in \hostEventScheduleSamples$ bijectively corresponds to a distinct tree from $\augmentedHostTreeSamples$, and consists of a vector of ordered pairs of $(\simulationTime, \hostEvent)$, where $\simulationTime$ is the simulation time of an event and $\hostEvent$ is the event (host speciation, host extinction, host dispersal, etc.) that occurs at that time on the particular tree to which it corresponds.
                \end{compactitem}
            \end{minipage}
    \end{description}

    \item For \textit{each} simulation replicate:
    \begin{enumerate}
        \item Sample a schedule of host tree events, $\hostEventSchedule_i$, from $\hostEventScheduleSamples$.
        \item Simulate symbiont tree, $\symbiontTree$, conditioned on $\hostEventSchedule$ and other parameters.
        % \item Scale symbiont tree by each substitution rate scaling factor to yield scaled symbiont tree $\scaledSymbiontTree$.
        % \item Calculate summary statistics on scaled symbiont tree, $\scaledSymbiontTree$.
        \item Calculate summary statistics on the symbiont tree, $\symbiontTree$.
    \end{enumerate}

\end{enumerate}

\end{document}
